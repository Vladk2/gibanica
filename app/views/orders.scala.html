@import java.util
@(orders: List[util.HashMap[String, String]])


@home("Orders"){
    <div>
        <i style="float: right;
            margin-right: 40px;">logged in: <b>@session.get("connected")</b> </i> <br> <br>

        <center>
                <div class="container">
                    <div class="row">

                        <div class="col-md-10 col-md-offset-1">

                            <div class="panel panel-default panel-table">
                                <div class="panel-heading">
                                    <div class="row">
                                        <div class="col col-xs-6">
                                                <!-- <h3 class="panel-title">Restaurants</h3> -->
                                        </div>
                                        <div class="col col-xs-6 text-right">
                                                <!-- <button type="button" class="btn btn-sm btn-primary btn-create">Add New</button> -->
                                        </div>
                                    </div>
                                </div>
                                <div class="panel-body">
                                    <table class="table table-striped table-bordered table-list">
                                        <thead>
                                            <tr>
                                                    <!--<th><em class="fa fa-cog"></em></th>-->
                                                <th>Guest</th>
                                                <th>Order Time</th>
                                                <th>Is Ready</th>
                                                @if(session.get("userType") == "waiter") {
                                                    <th>Edit Order</th>
                                                }
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @for(element <- orders) {
                                                <tr class="ordersRow" style="cursor:pointer">
                                                    <td id="kol1:@element.get("orderId")" class="orderColumn">@element.get("guestEmail")</td>
                                                    <td id="kol2:@element.get("orderId")" class="orderColumn">@element.get("orderTime")</td>
                                                    <td id="kol3:@element.get("orderId")" class="orderColumn">@element.get("orderReady")</td>
                                                    @if(session.get("userType") == "waiter") {
                                                        <td id="kol4:@element.get("orderId")" class="editColumn">
                                                            <em class="fa fa-gear"></em>
                                                        </td>
                                                    }
                                                </tr>
                                            }
                                        </tbody>
                                    </table>

                                </div>
                                <div class="panel-footer">
                                    <div class="row">
                                        <div class="col col-xs-4">
                                        </div>
                                        <div class="col col-xs-8">
                                            
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </center>
    </div>


    <script>
        $(document).ready(function() {
            $("#ordersButton").css("color", "#ffb79b");
            $(function () {
                var orderId;
                $(".orderColumn").hover(function () {
                    var this_id = $(this).attr('id');
                    var orId = this_id.split(':');
                    orderId = orId[1];
                    $("#kol1\\:" + orderId).css("background", "#e56e42");
                    $("#kol2\\:" + orderId).css("background", "#e56e42");
                    $("#kol3\\:" + orderId).css("background", "#e56e42");
                },
                function () {
                    $("#kol1\\:" + orderId).css("background", "#FFF");
                    $("#kol2\\:" + orderId).css("background", "#FFF");
                    $("#kol3\\:" + orderId).css("background", "#FFF");
                });
            });
            $('.editColumn').hover(function(){
                $(this).css("background", "#e559ce");
            },
            function(){
                $(this).css("background", "#FFF");
            });
            $('.orderColumn').on('click', function(){
               // uzmi id porudzbine, posalji ajaxom na server
               // onda prikazi modal sa listom hrane/pica i indikatorom
               // za svaki deo porudzbine da li je spreman
               var form_id = $(this).attr('id').split(':');

               var request = {"orderId": form_id[1]};

               $.ajax({
                   type: "POST",
                   url: "/previewOrder",
                   data: JSON.stringify(request),
                   contentType: 'application/json',
                   success: function (response) {
                       console.log("Server response: ");
                       console.log(response);
                   },
                   error: function (error) {
                       alert(error.responseText);
                   }
               });

            });
            $('.editColumn').on('click', function(){

               var form_id = $(this).attr('id').split(':');
               console.log(form_id[1]);
            });
        });
    </script>

}

